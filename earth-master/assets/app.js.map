{"version":3,"file":"app.js","sources":["app.raw.js","../node_modules/unfetch/dist/unfetch.mjs"],"sourcesContent":["import './app.raw.css';\nimport fetch from 'unfetch';\n\nconst color = '#14B7F4';\n\nif (!mapboxgl.supported()) {\n  alert(\"Hi sorry, looks like your browser is not supported to render the map 😢.\\n\\nYou could try to load this site on another (latest) browser perhaps? 🙏\");\n}\n\nmapboxgl.accessToken = 'pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjam9yZDY3OGkwZGVkM3dsaGQ3c3B5YWdpIn0.sg3ArlzdkBagspUgNEOyMA';\n\nconst map = new mapboxgl.Map({\n  container: 'map',\n  style: 'https://maps.tilehosting.com/styles/darkmatter/style.json?key=xjrAbdVfXA48AYcOS16e',\n  maxZoom: 15.5,\n  logoPosition: 'top-right',\n  attributionControl: false,\n  boxZoom: false,\n  zoom: 0.1,\n});\n\nconst $info = document.getElementById('info');\nconst $infoCountries = document.getElementById('info-countries');\nconst $infoPlaces = document.getElementById('info-places');\nconst $infoCheckins = document.getElementById('info-checkins');\nconst $countries = document.getElementById('countries');\n\nconst bodyClass = document.body.classList;\nfunction startInteractive(){\n  bodyClass.add('interactive');\n}\nmap.on('dragstart', startInteractive);\nmap.on('zoomstart', startInteractive);\n\nfunction endInteractive(){\n  bodyClass.remove('interactive');\n}\n$countries.addEventListener('touchstart', endInteractive, false);\n$countries.addEventListener('mouseenter', endInteractive);\n\nfunction toggleInteractive(){\n  bodyClass.toggle('interactive');\n}\nmap.on('click', toggleInteractive);\n\nconst numberWithCommas = x => x > 999 ? x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') : x;\n\nmap.addControl(new mapboxgl.AttributionControl({ compact: true }), 'top-right');\n\nclass LayersControl {\n  onAdd(map) {\n    const container = document.createElement('div');\n    container.className = 'mapboxgl-ctrl mapboxgl-ctrl-group';\n\n    const linesButton = document.createElement('button');\n    linesButton.innerHTML = `<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n      <path d=\"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.5-.07l-3.57 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07L4.93 15.5c.05.15.07.32.07.5 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.5.07l4.57-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56c-.05-.14-.07-.3-.07-.5 0-1.1.9-2 2-2s2 .9 2 2z\"/>\n    </svg>`;\n    linesButton.type = 'button';\n    linesButton.title = 'Show/hide journey lines';\n    linesButton.addEventListener('click', () => {\n      const visibility = map.getLayoutProperty('lines', 'visibility');\n      if (visibility === 'visible') {\n        map.setLayoutProperty('lines', 'visibility', 'none');\n        linesButton.classList.remove('active');\n      } else {\n        map.setLayoutProperty('lines', 'visibility', 'visible');\n        linesButton.classList.add('active');\n      }\n    }, false);\n\n    container.appendChild(linesButton);\n    return container;\n  }\n}\nmap.addControl(new LayersControl(), 'top-right');\n\nmap.addControl(new mapboxgl.NavigationControl(), 'top-right');\n\nlet slider;\nclass PitchControl {\n  onAdd() {\n    const container = document.createElement('div');\n    container.className = 'mapboxgl-ctrl pitch-ctrl';\n\n    container.innerHTML = `<svg viewBox=\"0 0 24 24\">\n      <title>Pitch</title>\n      <path d=\"M14 6l-3.8 5 3 3.8-1.7 1.2L7 10l-6 8h22L14 6z\"/>\n    </svg>`;\n\n    slider = document.createElement('input');\n    slider.type = 'range';\n    slider.step = 5;\n    slider.min = slider.value = 0;\n    slider.max = 60;\n    slider.className = 'pitch-slider';\n    slider.addEventListener('change', (e) => {\n      map.easeTo({ pitch: e.target.value });\n    }, false);\n\n    container.appendChild(slider);\n    return container;\n  }\n}\nmap.addControl(new PitchControl(), 'top-right');\nmap.on('pitchend', () => {\n  slider.value = map.getPitch();\n});\n\nfunction renderNumber(el, number) {\n  const frames = 60;\n  const inc = Math.ceil(number / frames);\n  let num = 0;\n  function render() {\n    if (num >= number) return;\n    num = num + inc;\n    if (num > number) num = number;\n    el.textContent = numberWithCommas(num);\n    requestAnimationFrame(render);\n  }\n  requestAnimationFrame(render);\n};\n\nPromise.all([\n  new Promise((resolve, reject) => {\n    map.on('load', resolve);\n    map.on('error', reject);\n  }),\n  fetch('data/checkins.min.geojson').then((data) => data.json()),\n]).then(([_, data]) => {\n  const _countries = {};\n  const _places = {};\n\n  const checkinsCount = data.features.length;\n\n  const lines = [];\n\n  data.features = data.features.filter((f, i) => {\n    const { id, country } = f.properties;\n    const isUnique = !_places[id];\n    const [lng, lat] = f.geometry.coordinates;\n    if (isUnique) {\n      if (!_countries[country]) {\n        const cc = f.properties.cc.toLowerCase();\n        _countries[country] = {\n          cc: cc,\n          bounds: new mapboxgl.LngLatBounds(),\n          places_count: 0,\n          checkins_count: 0,\n        };\n      }\n      _countries[country].bounds.extend([lng, lat]);\n      _countries[country].places_count++;\n      _places[id] = true;\n    }\n    _countries[country].checkins_count++;\n\n    const nextFeature = data.features[i+1];\n    if (nextFeature && f.properties.date === nextFeature.properties.date){\n      let [ nextLng, nextLat ] = nextFeature.geometry.coordinates;\n      // Magic below from https://github.com/mapbox/mapbox-gl-js/issues/3250#issuecomment-294887678\n      // This make sure the lines can cross the 180th meridian\n      nextLng += nextLng - lng > 180 ? -360 : lng - nextLng > 180 ? 360 : 0;\n      lines.push([[lng, lat], [nextLng, nextLat]]);\n    }\n\n    return isUnique;\n  });\n\n  const placesCount = Object.keys(_places).length;\n\n  const countries = Object.keys(_countries).map((country) => {\n    const c = _countries[country];\n    return {\n      name: country,\n      cc: c.cc,\n      bounds: c.bounds,\n      places_count: c.places_count,\n      checkins_count: c.checkins_count,\n    };\n  });\n\n  const countriesCount = countries.length;\n\n  countries.sort((a, b) => b.places_count - a.places_count);\n  countries.forEach((country, i) => {\n    const { cc, name, bounds, checkins_count, places_count } = country;\n    const $button = document.createElement('button');\n    $button.type = 'button';\n    $button.addEventListener('click', (e) => {\n      map.fitBounds(bounds, { padding: 150 });\n    }, false);\n    $button.innerHTML = `\n      <img src=\"data/countries/${cc}.svg\" width=\"50\" height=\"50\" alt=\"\"><br>\n      <b>${name}</b>\n      <br>\n      ${numberWithCommas(checkins_count)} check-in${checkins_count > 1 ? 's' : ''}\n      <br>\n      ${numberWithCommas(places_count)} place${places_count > 1 ? 's' : ''}\n    `;\n    $countries.appendChild($button);\n  });\n\n  const layers = map.getStyle().layers.reverse();\n  const labelLayerIdx = layers.findIndex(function (layer) {\n    return layer.type !== 'symbol';\n  });\n  const labelLayerId = labelLayerIdx !== -1 ? layers[labelLayerIdx].id : undefined;\n\n  layers.forEach(function(layer){\n    if (layer['source-layer'] === 'place' && layer.maxzoom){\n      map.setLayerZoomRange(layer.id, Math.min(layer.maxzoom-4, 24), 24);\n    } else if (layer['source-layer'] === 'boundary'){\n      map.setPaintProperty(layer.id, 'line-opacity', .2);\n    } else if (layer['source-layer'] === 'transportation'){\n      map.setPaintProperty(layer.id, 'line-opacity', .6);\n    }\n  });\n  map.setPaintProperty('background', 'background-color', '#080808');\n\n  map.addSource('checkins', {\n    type: 'geojson',\n    data: data,\n    cluster: true,\n    clusterMaxZoom: 10,\n    clusterRadius: 10,\n  });\n\n  map.addLayer({\n    id: 'cluster',\n    type: 'circle',\n    source: 'checkins',\n    filter: ['has', 'point_count'],\n    paint: {\n      'circle-radius': [\n        'interpolate', ['linear'], ['get', 'point_count'],\n        3, 7,\n        10, 10,\n        100, 13,\n        200, 16\n      ],\n      'circle-color': color,\n      'circle-opacity': .9,\n      'circle-stroke-width': [\n        'interpolate', ['linear'], ['get', 'point_count'],\n        3, 3,\n        50, 6\n      ],\n      'circle-stroke-color': color,\n      'circle-stroke-opacity': .3,\n    }\n  });\n\n  map.addLayer({\n    id: 'checkins-count',\n    type: 'symbol',\n    source: 'checkins',\n    filter: ['has', 'point_count'],\n    maxzoom: 11,\n    layout: {\n      'text-field': '{point_count_abbreviated}',\n      'text-size': 10,\n    },\n  });\n\n  map.addLayer({\n    id: 'checkins',\n    type: 'circle',\n    source: 'checkins',\n    minzoom: 8,\n    filter: ['!has', 'point_count'],\n    paint: {\n      'circle-radius': 3,\n      'circle-color': color,\n      'circle-opacity': .9,\n      'circle-stroke-width': 3,\n      'circle-stroke-color': color,\n      'circle-stroke-opacity': .1,\n    },\n  }, labelLayerId);\n\n  map.once('data', () => {\n    requestAnimationFrame(() => {\n      renderNumber($infoCheckins, checkinsCount);\n      renderNumber($infoPlaces, placesCount);\n      renderNumber($infoCountries, countriesCount);\n      bodyClass.add('render');\n    });\n  });\n\n  map.on('mouseenter', 'cluster', () => {\n    map.getCanvas().style.cursor = 'pointer';\n  });\n\n  map.on('click', 'cluster', (e) => {\n    e.originalEvent.stopPropagation();\n    map.flyTo({\n      center: e.lngLat,\n      zoom: map.getZoom() + 2,\n    });\n  });\n\n  map.on('mouseleave', 'cluster', () => {\n    map.getCanvas().style.cursor = '';\n  });\n\n  map.addLayer({\n    id: 'lines',\n    type: 'line',\n    source: {\n      type: 'geojson',\n      data: {\n        type: 'Feature',\n        geometry: {\n          type: 'MultiLineString',\n          coordinates: lines,\n        },\n      },\n    },\n    layout: {\n      visibility: 'none',\n    },\n    paint: {\n      'line-color': \"#fff\",\n      'line-opacity': .3,\n    },\n  }, labelLayerId);\n\n  map.addLayer({\n    id: '3d-buildings',\n    source: 'openmaptiles',\n    'source-layer': 'building',\n    type: 'fill-extrusion',\n    minzoom: 14,\n    paint: {\n      'fill-extrusion-color': '#999',\n      'fill-extrusion-height': 50,\n      'fill-extrusion-opacity': .1,\n      'fill-extrusion-base': {\n        type: 'identity',\n        property: 'min_height',\n      },\n      'fill-extrusion-opacity': .6,\n    },\n  }, labelLayerId);\n\n  // TODO: filter by date\n  // const filterByDate = (startDate, endDate) => {\n  //   map.setFilter('checkins', [\n  //     'all',\n  //     ['>=', 'date', startDate],\n  //     ['<=', 'date', endDate],\n  //     map.getFilter('checkins'),\n  //   ]);\n  // };\n  // filterByDate(20160101, 20161212);\n\n  const err = (e) => {\n    const reload = confirm('Oops, the map is acting weird now. Reload this page? 😅');\n    if (reload) location.reload();\n    console.error(e);\n  };\n  map.on('error', err);\n  window.onerror = err;\n});\n","export default function(e,n){return n=n||{},new Promise(function(t,r){var s=new XMLHttpRequest;for(var o in s.open(n.method||\"get\",e,!0),n.headers)s.setRequestHeader(o,n.headers[o]);function u(){var e,n=[],t=[],r={};return s.getAllResponseHeaders().replace(/^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm,function(s,o,u){n.push(o=o.toLowerCase()),t.push([o,u]),r[o]=(e=r[o])?e+\",\"+u:u}),{ok:2==(s.status/100|0),status:s.status,statusText:s.statusText,url:s.responseURL,clone:u,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},headers:{keys:function(){return n},entries:function(){return t},get:function(e){return r[e.toLowerCase()]},has:function(e){return e.toLowerCase()in r}}}}s.withCredentials=\"include\"==n.credentials,s.onload=function(){t(u())},s.onerror=r,s.send(n.body||null)})};\n//# sourceMappingURL=unfetch.mjs.map\n"],"names":["color","mapboxgl","supported","alert","accessToken","map","Map","container","style","maxZoom","logoPosition","attributionControl","boxZoom","zoom","$infoCountries","document","getElementById","$infoPlaces","$infoCheckins","$countries","bodyClass","body","classList","startInteractive","add","endInteractive","remove","on","addEventListener","toggle","numberWithCommas","x","toString","replace","addControl","AttributionControl","compact","slider","LayersControl","createElement","className","linesButton","innerHTML","type","title","getLayoutProperty","setLayoutProperty","appendChild","NavigationControl","e","n","PitchControl","step","min","value","max","easeTo","pitch","target","renderNumber","el","number","inc","Math","ceil","num","requestAnimationFrame","render","textContent","getPitch","Promise","all","resolve","reject","t","r","s","XMLHttpRequest","o","open","method","headers","setRequestHeader","u","getAllResponseHeaders","push","toLowerCase","ok","status","statusText","url","responseURL","clone","text","responseText","json","then","JSON","parse","blob","Blob","response","keys","entries","get","has","withCredentials","credentials","onload","onerror","send","data","_countries","_places","checkinsCount","features","length","lines","filter","f","i","properties","id","country","isUnique","geometry","coordinates","lng","lat","cc","bounds","LngLatBounds","places_count","checkins_count","extend","nextFeature","date","nextLng","nextLat","placesCount","Object","countries","c","name","countriesCount","sort","a","b","forEach","$button","fitBounds","padding","layers","getStyle","reverse","labelLayerIdx","findIndex","layer","labelLayerId","undefined","maxzoom","setLayerZoomRange","setPaintProperty","addSource","cluster","clusterMaxZoom","clusterRadius","addLayer","source","paint","layout","minzoom","once","getCanvas","cursor","originalEvent","stopPropagation","flyTo","center","lngLat","getZoom","visibility","property","err","confirm","location","reload","console","error","window"],"mappings":"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"}